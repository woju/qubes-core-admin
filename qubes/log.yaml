---
version: 1
disable_existing_loggers: False

LOGFILE:
  - &LOGFILE /var/log/qubes/qubes.log

LEVELNAME: &LEVELNAME
  DEBUG:    {color: green}
  INFO:     {color: magenta}
  VERBOSE:  {color: blue}
  WARNING:  {color: yellow}
  ERROR:    {color: red}
  CRITICAL: {color: [red, bold]}

# Colors
# black, red, green, yellow, blue, magenta, cyan, white
#
# Styles:
# bold, underline, inverse

formatters:
  console:
    format: '%(message)s'
  simple:
    format: "%(asctime)s - %(levelname)9s - %(message)s"
  info:
    format: '%(asctime)s%(levelname)9s: %(module)s.%(funcName)s: %(message)s'
  color:
    (): logging.handlers.ColorFormatter
    format: '%(asctime)s%(levelname)9s: %(name)s:[%(processName)s %(module)s.%(funcName)s:%(lineno)d]: %(message)s'
    colors:
      levelname:
        <<: *LEVELNAME  # Alias
        message:     {}
      asctime:     {color: yellow}
      name:        {color: blue}
      processname: {color: white}
      module:      {color: cyan}
      funcName:    {color: [black, inverse]}
      lineno:      {color: red}
    dynamic_labels: [lineno,]

  debug:
    format: '%(asctime)s%(levelname)9s: [%(processName)s %(module)s.%(funcName)s:%(lineno)d] %(name)s: %(message)s'

handlers:
  CONSOLE_HANDLER: &CONSOLE_HANDLER
    class: logging.StreamHandler
    stream: ext://sys.stdout
    formatter: simple

  info_console:
    <<: *CONSOLE_HANDLER

  debug_console:
    <<: *CONSOLE_HANDLER
    formatter: debug

  color_console:
    <<: *CONSOLE_HANDLER
    formatter: color

  FILE_HANDLER: &FILE_HANDLER
    class: logging.handlers.RotatingFileHandler
    formatter: info
    filename: *LOGFILE
    maxBytes: 10485760 # 10MB
    backupCount: 5
    encoding: utf8

  info_file_handler:
    <<: *FILE_HANDLER

  debug_file_handler:
    <<: *FILE_HANDLER
    formatter: debug

  color_file_handler:
    <<: *FILE_HANDLER
    formatter: color

loggers:
  qubes:
    level: INFO
    handlers: [info_console, info_file_handler]
    propagate: no
  qubes.vm:
    level: DEBUG
    handlers: [debug_console, debug_file_handler]
    propagate: no

root:
  level: INFO
  handlers: [color_console, info_file_handler]
  #handlers: [color_console, color_file_handler]

...
